(self.webpackChunkweb=self.webpackChunkweb||[]).push([[213],{1603:(e,n,t)=>{"use strict";t.d(n,{I:()=>u});var a=t(4575),o=t.n(a),i=t(3913),l=t.n(i),r=t(2367),c=t(9118),s=t(5797),d="\n<style>\n    #message{\n        min-width: 300px;\n        margin: 0px;\n        padding: 1px;\n        background-color: aliceblue;\n        box-sizing: border-box;\n    }\n\n    #message-config{\n        width: 100%;\n        padding: 5px;\n        background-color: beige;\n        border-radius: 10px;\n        box-sizing: border-box;\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        align-items: center;\n    }\n\n    #connection-type{\n        --button-pusher-bt-bg: orange;\n    }\n\n    #message-size{\n        width: 10ch;\n        height: 2.5ch;\n        border-radius: 5px;\n        text-align: center;\n        background: orange;\n    }\n\n    #message-length{\n        width: 10ch;\n        height: 2.5ch;\n        border-radius: 5px;\n        text-align: center;\n    }\n\n    #message-config label{\n        font-weight: bold;\n    }\n\n    #message-header{\n        width: 100%;\n        padding: 5px;\n        background-color: orange;\n        border-radius: 10px;\n        box-sizing: border-box;\n        display: flex;\n        flex-wrap: wrap;\n        gap: 2px;\n        justify-content: stretch;\n    }\n\n    .header-field{\n        --button-pusher-bt-bg: peachpuff;\n    }\n\n    #message-header label{\n        font-weight: bold;\n    }\n\n    #message-version{\n        width: 2ch;\n        height: 2.5ch;\n        border-radius: 5px;\n    }\n\n    #message-id{\n        width: 12ch;\n        height: 2.5ch;\n    }\n\n    #message-code{\n        margin: 0px;\n        padding: 0px;\n    }\n\n    #message-code select{\n        padding: 3px;\n        border-radius: 5px;\n        background: white;\n    }\n\n    #message-token{\n        width: 100%;\n        height: 2.5ch;\n        max-width: 28ch;\n    }\n\n    #message-options{\n        display: flex;\n        flex-direction: column;\n        padding: 5px;\n        background-color: bisque;\n        border-radius: 10px;\n    }\n\n    #message-option-header{\n        display: flex;\n        justify-content: space-between;\n    }\n\n    #message-option-header span{\n        font-weight: bold;\n    }\n\n    #add-option\n    {\n        color: lawngreen;\n        background-color: white;\n        font-weight: bold;\n        transition: background-color 0.5s ease;\n        cursor: pointer;\n        border-style: outset;\n        border-radius: 5px;\n    }\n\n    #add-option:hover\n    {\n        color: white;\n        background-color: lawngreen;\n    }\n\n    #add-option:active\n    {\n        border-style: inset;\n    }\n\n    #message-option-container\n    {\n        max-height: 200px;\n        flex-grow: 1;\n        margin-top: 2px;\n        overflow: auto;\n    }\n\n    .coap-option\n    {\n        width: 100%;\n        background-color: white;\n        --closeable-close-bg: white;\n        --closeable-bg-hover: red;\n        --closeable-padding: 5px;\n        --closeable-close-color: red;\n        --closeable-color-hover: white;\n        margin-bottom: 2px;\n        box-sizing: border-box;\n        color: black;\n    }\n\n    .coap-op-invalid{\n        display: none;\n        font-style: italic;\n    }\n\n    .coap-option-select{\n        border-style: none;\n        padding: 3px;\n        border-radius: 5px;\n        background-color: antiquewhite;\n    }\n\n    .coap-op-container-value{\n        display: flex;\n        flex-wrap: wrap;\n        align-items: flex-start;\n        gap: 2px;\n    }\n\n    .coap-op-value{\n        flex-grow: 1;\n    }\n\n    .coap-op-field-value{\n        padding: 3px;\n        border-radius: 5px;\n        width: 100%;\n        box-sizing: border-box;\n        background-color: antiquewhite;\n        --token-data-bg: antiquewhite;\n    }\n\n    #container-payload{\n        width: 100%;\n        padding: 5px;\n        box-sizing: border-box;\n        background-color: yellow;\n        border-radius: 10px;\n    }\n\n    #container-payload label\n    {\n        display: block;\n        font-weight: bold;\n    }\n\n    #payload-size\n    {\n        font-weight: normal;\n    }\n\n    #message-payload{\n        width: 100%;\n        box-sizing: border-box;\n        max-height: 200px;\n        background-color: cornsilk;\n    }\n</style>\n<div id=message>\n    <div id=message-config>\n        <button-pusher id=connection-type title='Connection Type'></button-pusher>\n        <label>Size: <input id=message-size disabled></label>\n    </div>\n    <div id=message-header>\n        <div class=header-field>\n            <input type=checkbox id=set-length class=reliable title='Set Length\nTCP: check\nWebsocket: uncheck' checked>\n            <label class=reliable>Length: <input disabled id=message-length></label>\n            <label class=unreliable>Ver: <input id=message-version value='01' disabled title=Version></label>\n            <label title='Message ID' class=unreliable>M.ID: <message-id-field id=message-id></message-id-field></label>\n        </div>\n        <button-pusher class='header-field unreliable' id=message-type title=type></button-pusher>\n        <div id=message-code></div>\n        <token-field class=header-field id=message-token title=token placeholder=token max-size=8></token-field>\n    </div>\n    <div id=message-options>\n        <div id=message-option-header>\n            <span>Options</span><button id=add-option title='Add option'>+</button>\n        </div>\n        <div id=message-option-container></div>\n    </div>\n    <div id=container-payload>\n        <convert-container id=message-payload types='[\"text\", \"hex\", \"binary\"]' select='text' contentEditable></convert-container>\n        <label>Payload Size: <span id=payload-size>0</span></label>\n    </div>\n</div>",p=document.createElement("template");p.innerHTML="\n<style>\n    .coap-block-container{\n        width: 100%;\n        box-sizing: border-box;\n    }\n\n    .coap-block-number\n    {\n        max-width: 15ch;\n        box-sizing: border-box;\n        padding: 3px;\n        border-radius: 5px;\n        background-color: antiquewhite;\n    }\n\n    .coap-block-size-select\n    {\n        padding: 3px;\n        border-radius: 5px;\n        background-color: antiquewhite;\n    }\n    \n    .coap-block-container label{font-weight: bold;}\n</style>\n<span class=coap-block-container>\n    <input type=number placeholder=Number class=coap-block-number min=0 title='Packet Number'>\n    <label title=More>M<input type=checkbox class=coap-block-more></label>\n    <select class=coap-block-size-select title='Max Packet Size'>\n        <option value=0>16</option>\n        <option value=1>32</option>\n        <option value=2>64</option>\n        <option value=3>128</option>\n        <option value=4>256</option>\n        <option value=5>512</option>\n        <option value=6>1024</option>\n        <option value=7>BERT</option>\n    </select>\n</span>";var u=function(){function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o()(this,e),this._ext_container=n,this._container=n.attachShadow({mode:"open"});var a=null===t.type?null:t.type instanceof Array?t.type:Object.values(r.dt),i=null===t.code?null:t.code instanceof Array?t.code:Object.values(r.WY),l=null===t.option?null:t.option instanceof Array?t.option:Object.values(r.Kw),c=void 0===t.payload||Boolean(t.payload),s=null===t.content_format?null:t.content_format instanceof Array?t.content_format:Object.values(r.Pv),p=t.connection_type?t.connection_type:Object.values(r.x$);this._conn_type=Array.isArray(p)?p[0].value:"reliable"==p?"reliable":"unreliable",this._container.innerHTML=d,this._draw(p,a,i,l,c,s,t.code_container_type)}return l()(e,[{key:"data",value:function(){var n=[],t={conn_type:this._conn_type,length_set:this._container.querySelector("#set-length").checked,version:+this._container.querySelector("#message-version").value,mid:this.data_mid(),type:this.data_type(),code:this.data_code(),token:this._container.querySelector("#message-token").byte_array(),option:this.parse_options(n),payload:this._container.querySelector("#message-payload").data()};return t.type||"unreliable"!=this._conn_type||e.set_error(n,"header","type","value not set"),t.code||e.set_error(n,"header","code","value not set"),t.mid.data.length||"unreliable"!=this._conn_type||e.set_error(n,"header","mid","value not set"),{data:t,error:n,has_error:Boolean(n.length)}}},{key:"serialize",value:function(){return"reliable"==this._conn_type?this.serialize_reliable():this.serialize_unreliable()}},{key:"serialize_unreliable",value:function(){var e=this.data();if(e.has_error)return{data:[],error:["parser error"],has_error:!0};e=e.data;var n=[];return e.option.forEach((function(e){var t=new r.yw.option(e.code,e.value);t&&n.push(t)})),r.yw.serialize(e.type.code,e.code.code,e.mid.value,e.token,n,e.payload)}},{key:"serialize_reliable",value:function(){var e=this.data();if(e.has_error)return{data:[],error:["parser error"],has_error:!0};e=e.data;var n=[];return e.option.forEach((function(e){var t=new r.yw.option(e.code,e.value);t&&n.push(t)})),r.yw.serialize_reliable(e.code.code,e.token,n,e.payload,e.length_set)}},{key:"data_mid",value:function(){return{value:+this._container.querySelector("#message-id").value,data:this._container.querySelector("#message-id").byte_array()}}},{key:"data_type",value:function(){var e=this._container.querySelector("#message-type").selected();return{value:e,code:r.dt[e].code}}},{key:"data_code",value:function(){var e=this._container.querySelector("#message-code .header-field"),n="select"==e.localName?e.value:e.selected();return{value:n,code:r.TU[n].code}}},{key:"connection_type",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null!=e&&("reliable"==e?(this._container.querySelectorAll(".reliable").forEach((function(e){e.style.display="inline-block"})),this._container.querySelectorAll(".unreliable").forEach((function(e){e.style.display="none"})),this._conn_type=e):"unreliable"==e&&(this._container.querySelectorAll(".reliable").forEach((function(e){e.style.display="none"})),this._container.querySelectorAll(".unreliable").forEach((function(e){e.style.display="inline-block"})),this._conn_type=e)),this._conn_type}},{key:"_set_message_size",value:function(e){var n=this._container.querySelector("#message-size");e.has_error?n.value="":n.value=e.data.length}},{key:"_set_message_length",value:function(e){var n=this._container.querySelector("#set-length").checked,t=this._container.querySelector("#message-length");if(n){var a=r.yw.parse_reliable(e.data,!0);t.value=a.has_error?0:a.size-a.header_size}else t.value=0}},{key:"_coap_change_event",value:function(e){var n=this.serialize();this._set_message_size(n),this._set_message_length(n),this._ext_container.dispatchEvent(new CustomEvent("coap-change",{detail:n}))}},{key:"_draw",value:function(n,t,a,o,i,l,r){var c,s,d=this;if(Array.isArray(n)&&2==n.length){var p=this._container.querySelector("#connection-type");p.add(n),p.select(this._conn_type),p.addEventListener("click",(function(e){var n=e.composedPath()[0];n.value&&d.connection_type(n.value)}))}else this._container.querySelector("#message-config").style.display="none","reliable"==n||"unreliable"==n?this.connection_type(n):this._conn_type(this._conn_type);if(t){var u=this._container.querySelector("#message-type");u.add(t),u.select(t[0].value)}else this._container.querySelector("#message-type").style.display="none";if(a){var h=this._container.querySelector("#message-code");if("select"==r)h.appendChild((c=a,(s=document.createElement("select")).classList.add("header-field"),c.forEach((function(e){var n=document.createElement("option");n.value=e.value,n.textContent="".concat(e.str_code," ").concat(e.name),s.appendChild(n)})),s));else{var v=document.createElement("button-pusher");v.add(a),v.classList.add("header-field"),v.title="Code",v.select(a[0].value),h.appendChild(v)}}else this._container.querySelector("#message-code").style.display="none";if(o){var b=document.createElement("template");b.innerHTML=e.create_template_option(o);var y=document.createElement("template");y.innerHTML=e.create_template_content_format(l),this._container.querySelector("#add-option").addEventListener("click",(function(e){d._container.querySelector("#message-option-container").appendChild(b.content.cloneNode(!0))})),this._container.querySelector("#message-option-container").addEventListener("change",(function(n){var t=n.composedPath()[0];if(t.classList.contains("coap-option-select")){var a=o.find((function(e){return e.value==t.selectedOptions[0].value}));if(a){var i=t.parentElement.querySelector(".coap-op-value");e.make_op_field_value(i,a,y)}}}))}else this._container.querySelector("#message-options").style.display="none";if(i){var g=this._container.querySelector("#message-payload"),m=this._container.querySelector("#payload-size");g.addEventListener("keyup",(function(e){m.textContent=g.size}))}else this._container.querySelector("#container-payload").style.display="none";this.connection_type(this._conn_type),this._container.addEventListener("click",this._coap_change_event.bind(this)),this._container.addEventListener("keyup",this._coap_change_event.bind(this))}},{key:"parse_options",value:function(e){var n=[];return this._container.querySelector("#message-option-container").querySelectorAll(".coap-op-container-value").forEach((function(e){var t=e.querySelector(".coap-option-select").selectedOptions[0].value,a=e.querySelector(".coap-op-value");if(t in r.Kw)if(t!=r.Kw.accept.value&&t!=r.Kw.content_format.value){if(t==r.Kw.no_response.value){var o=a.querySelector(".coap-op-input-value").selected(),i=0;return o&&o.forEach((function(e){i|=r.iA[e].code})),void n.push({code:r.Kw[t].code,option:t,value:i,name:o})}if(t!=r.Kw.block1.value&&t!=r.Kw.block2.value)switch(r.Kw[t].type){case"empty":n.push({code:r.Kw[t].code,option:t,value:null,name:"empty"});break;case"uint":var l=a.querySelector(".coap-op-input-value").value;n.push({code:r.Kw[t].code,option:t,value:+l,name:+a.querySelector(".coap-op-input-value").value});break;case"string":n.push({code:r.Kw[t].code,option:t,value:a.querySelector(".coap-op-input-value").value,name:a.querySelector(".coap-op-input-value").value});break;case"opaque":var d=a.querySelector(".coap-op-input-value");n.push({code:r.Kw[t].code,option:t,value:d.byte_array(),name:d.text})}else{var p=a.querySelector(".coap-block-number"),u=a.querySelector(".coap-block-more"),h=a.querySelector(".coap-block-size-select"),v={szx:+h.value,size:7==+h.value?h.selectedOptions[0].textContent:+h.selectedOptions[0].textContent,more:u.checked?1:0,number:+p.value,value:+h.value|u.checked<<3|+p.value<<4},b=function(e){var n=!1;return e.filter((function(e){return!(!n&&0==e||(n=!0,0))}))}(c.O.parse(v.value,s.Nm.uint32be.value));n.push({code:r.Kw[t].code,option:t,value:b,name:v})}}else{var y=a.querySelector(".coap-option-select").selectedOptions[0].value;n.push({code:r.Kw[t].code,option:t,value:r.Pv[y].code,name:y})}})),n}},{key:"node",get:function(){return this._container}}],[{key:"set_error",value:function(e,n,t,a){return e.push({type:n,value:t,error:a})}},{key:"create_template_option",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=null==e?Object.values(r.Kw):e;var n="<closeable-status show=true behaviour=close class=coap-option>\n                        <div class=coap-op-container-value><select class=coap-option-select>\n                            <option value=invalid class=coap-op-invalid>Options</option>";return e.forEach((function(e){n+="<option value=".concat(e.value,">").concat(e.name,"</option>")})),n+="</select><span class=coap-op-value></span></div></closeable-status>"}},{key:"create_template_content_format",value:function(e){var n='<select class="coap-option-select coap-op-input-value">';return e.forEach((function(e){n+="<option value=".concat(e.value,">").concat(e.name,"</option>")})),n+="</select>"}},{key:"make_op_field_value",value:function(n,t,a){if(n.innerHTML="",t.value!=r.Kw.accept.value&&t.value!=r.Kw.content_format.value){if(t.value==r.Kw.no_response.value){var o=document.createElement("button-pusher");return o.add(Object.values(r.iA)),o.classList.add("coap-op-input-value"),o.multi=!0,void n.appendChild(o)}if(t.value!=r.Kw.block1.value&&t.value!=r.Kw.block2.value)switch(t.type){case"empty":break;case"uint":var i=document.createElement("input");i.type="number",i.min="".concat(Math.pow(2,t.min)-1),i.max="".concat(Math.pow(2,8*t.max)-1),i.classList.add("coap-op-field-value","coap-op-input-value"),i.style.maxWidth="20ch",t.default&&(i.value=t.default),n.appendChild(i),i.focus();break;case"string":var l=document.createElement("input");l.type="text",l.minLength="".concat(t.min),l.maxLength="".concat(t.max),l.classList.add("coap-op-field-value","coap-op-input-value"),n.appendChild(l),l.focus();break;case"opaque":var c=document.createElement("token-field");c.classList.add("coap-op-field-value","coap-op-input-value"),c.max_size=t.max,c.style.padding="0px",n.appendChild(c),c.focus()}else n.appendChild(e.make_op_block_field())}else n.appendChild(a.content.cloneNode(!0))}},{key:"make_op_block_field",value:function(){return p.content.cloneNode(!0)}}]),e}()}}]);